{% extends 'base1.html' %} {% block content %}
<style>
  .problem-page-container {
    max-width: 1000px;
    margin: 40px auto;
    padding: 20px;
  }

  .top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    gap: 10px;
  }

  .top-bar input[type="text"] {
    flex: 1;
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 10px;
  }

  .problem-grid {
    height: 60vh;
    overflow-y: scroll;
    border: 1px solid #ccc;
    border-radius: 12px;
    padding: 16px;
    background-color: white;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
  }

  .problem-item {
    padding: 12px;
    margin-bottom: 12px;
    border-bottom: 1px solid #eee;
  }

  .pagination-btn {
    padding: 5px 5px;
    border-radius: 10px;
    border: none;
    background-color: #ffffff;
    color: #32cd32;
    cursor: pointer;
    text-decoration: none;
    display: inline-block;
  }
  .pagination-btn:hover {
    background-color: #f6f6f6;
    transform: scale(1.03);
  }

  .difficulty {
    padding: 0px 0px;
    border-radius: 12px;
    font-size: 14px;
    display: inline-block;
    min-width: 70px;
    text-align: center;
    float: right; /* makes it align toward the right inside a container */
  }

  .difficulty-easy {
    color: #4caf50;
    background-color: rgba(76, 175, 80, 0.15); /* Green with 10% opacity */
  }

  .difficulty-medium {
    color: #ffa500;
    background-color: rgba(255, 165, 0, 0.15);
  }

  .difficulty-hard {
    color: #e53935;
    background-color: rgba(229, 57, 53, 0.15);
  }

  /* Removed .filter-btn related styles */

  .hidden {
    display: none;
  }
  .no-results {
    margin: 6px 0 0;
    color: #666;
    font-style: italic;
  }
  .hidden {
    display: none;
  }
</style>

<div class="problem-page-container">
  <!-- Search (filter button removed) -->
  <div class="top-bar">
    <input type="text" id="searchBox" placeholder="Search problems..." />
  </div>

  <!-- Problem list container -->
  <div class="problem-grid" id="problemGrid">
    <p id="noResults" class="no-results hidden">No results found.</p>
    {% for problem in problems %}
    <div class="problem-item">
      <a href="{% url 'problem_detail' problem.id %}">
        <strong>{{ problem.problem_name }}</strong>
        <span
          class="difficulty {% if problem.problem_difficulty == 1 %}difficulty-easy {% elif problem.problem_difficulty == 2 %}difficulty-medium {% elif problem.problem_difficulty == 3 %}difficulty-hard {% endif %}"
        >
          {{ problem.get_problem_difficulty_display }}
        </span>
      </a>
    </div>
    {% empty %}
    <p>No problems available.</p>
    {% endfor %}
  </div>

  <!-- Prev / Next arrows -->
  <div class="pagination" style="text-align: center; margin-top: 30px">
    {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}">
      <button class="pagination-btn">&larr; Previous</button>
    </a>
    {% endif %}

    <span style="margin: 5px 10px"
      >Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span
    >

    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}">
      <button class="pagination-btn">Next &rarr;</button>
    </a>
    {% endif %}
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const searchBox = document.getElementById("searchBox");
    const problems = Array.from(document.querySelectorAll(".problem-item"));
    const noResults = document.getElementById("noResults");

    function filter() {
      const term = searchBox.value.trim().toLowerCase();
      let visibleCount = 0;

      problems.forEach((problem) => {
        const text = problem.textContent.trim().toLowerCase();
        const match = text.includes(term);
        problem.style.display = match ? "" : "none";
        if (match) visibleCount++;
      });

      if (term.length > 0 && visibleCount === 0) {
        noResults.classList.remove("hidden");
        noResults.textContent = `No results for “${term}”.`;
      } else {
        noResults.classList.add("hidden");
      }
    }

    // Live filter
    searchBox.addEventListener("input", filter);

    // Optional: support prefilled query (?q=...)
    const params = new URLSearchParams(window.location.search);
    const q = params.get("q");
    if (q) {
      searchBox.value = q;
      filter();
    }
  });
</script>
{% endblock %}
